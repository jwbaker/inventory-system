{% extends 'uw_inventory/item_base.html' %}
{% load uw_inventory_field_tags %}

{% block page_heading %}New Item{% endblock page_heading %}

{% block page_body %}
  <form action="{% url 'uw_inventory.views.inventory_add' %}" method="post" id="itemForm">
    {% csrf_token %}
    {% show_field form.name 'text' %}
    {% show_field form.status 'dropdown' %}
    {% show_field form.purchase_price 'currency' %}
    {% show_field form.description 'textarea' %}
    {% show_field form.manufacture_date 'date' %}
  </form>
{% endblock page_body %}

{% block js_includes %}
  {{ block.super }}
  <script type="text/javascript">
    $('#pageSave').click(function(){
      $('form#itemForm').submit();
    });
  </script>

  <script type="text/javascript">
    var onChangeHandler = function(event){
      {# Empty values aren't considered 'changes' #}
      if(event.target.value === ''){
        pageDirty = false;
      } else{
        pageDirty = true;
      }
    }

    $('select').change(onChangeHandler);
    $('input').change(onChangeHandler);
    $('textarea').change(onChangeHandler);
  </script>
{% endblock js_includes %}