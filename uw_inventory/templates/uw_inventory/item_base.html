{% extends 'uw_inventory_system/base.html' %}
{% load uw_inventory_modal_tags %}

{% block css_includes %}
  <style type='text/css'>
    ul.errorlist li{
      list-style-type: none;
    }
  </style>
{% endblock css_includes %}

{% block navbar_right %}
  <li>
    <button class="btn navbar-btn btn-success" id="pageSave">Save</button>
  </li>
  <li>
    <button class="btn navbar-btn btn-danger" id="pageCancel">Cancel</button>
  </li>
  {{ block.super }}
{% endblock navbar_right %}

{% block content %}
    <div class="row">
    <div class="col-xs-8 col-xs-offset-2">
      <div class="panel panel-default">
        <div class="panel-heading">{% block page_heading %}{% endblock page_heading %}</div>
            {% block page_body %}
            {% endblock page_body %}
        </div>
    </div>
  </div>
{% endblock content %}

{% block modal %}
  {% confirm_modal 'Exit' %}
{% endblock modal %}

{% block js_includes %}
  <script type="text/javascript">
    {# Redirect on the cancel button #}
    $('#pageCancel').click(function(){
      window.location = {% url 'uw_inventory.views.inventory_list' %};
    });
  </script>

  <script type="text/javascript">
    {# We want to confirm user intent if they try to navigate away with unsaved changes #}
    var pageDirty = false;
    var targetDestination;
    $('.navigate').parent().click(function(event){
      if(pageDirty){
        event.preventDefault();
        event.stopPropagation();
        targetDestination = event.target.href;
        $('#confirmExitModal').modal('show');
      }
    });

    $('#confirmExitModalContinue').click(function(){
      $('#confirmExitModal').modal('hide');
      window.location = targetDestination || {% url 'uw_inventory.views.inventory_list' %};
    });

    $('#confirmExitModalCancel').click(function(){
      $('#confirmExitModal').modal('hide');
    });
  </script>
{% endblock js_includes %}