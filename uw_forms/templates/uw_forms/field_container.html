{% load uw_inventory_misc_tags %}
{% load uw_forms_field_tags %}

{% set_help_text field_label as field_help %}

<div class="singleton-field form-group list-group-item clearfix {% if field.errors %}list-group-item-danger has-error{% endif %}">
  <div class="col-xs-3">
    <label for="{{ field_id }}" class="control-label">
      {{ field_label }}
      {% if field_required %}<span class="text-danger">*</span>{% endif %}
    </label>
  </div>
  <div class="col-xs-8 field-container">
    {# For static calls, we don't want to render any input elements. #}
    {# the user isn't allowed to modify the field #}
    {% if caller == "static" %}
      <p class="form-control-static">
        {{ field_value }}
      </p>
    {% else %}
      {# In non-static calls, the static label will be generated by the field widget itself #}
      {{ field }}
      {{ field.errors }}
    {% endif %}

  </div>

  {# If we came from a show_editable_field tag and we are allowed to edit this model #}
  {% if caller == "edit" and can_edit %}
    <div class="col-xs-1">
      {% icon 'save hidden' %}
      {% icon 'cancel hidden' %}
      {% icon 'edit' %}
      {% if field_help %}
        {% icon 'field-help persist-visible' data_toggle='popover' data_trigger='focus' data_html='True' data_content=field_help %}
      {% endif %}
    </div>
  {% elif caller == 'static' or caller == 'field' %}
    <div class="col-xs-1">
      {% if field_help %}
        {% icon 'field-help persist-visible' title='Help with this field' data_toggle='popover' data_trigger='focus' data_html='True' data_content=field_help %}
      {% endif %}
    </div>
  {% endif %}
</div>